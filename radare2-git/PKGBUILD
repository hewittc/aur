pkgname="radare2-git"
pkgver=3.4.1.r26.g0096dbfdb
pkgrel=1
pkgdesc="Open-source tools to disasm, debug, analyze and manipulate binary files"
arch=('i686' 'x86_64' 'armv7h' 'aarch64')
url="http://radare.org"
license=('GPL3' 'LGPL3')

makedepends=('ninja')

provides=('radare2')
conflicts=('radare2')

source=("$pkgname"::"git://github.com/radare/radare2.git")
sha256sums=('SKIP')

pkgver () {
  cd "${srcdir}/${pkgname}"
  git describe --long --tags | sed 's/\([^-]*-g\)/r\1/;s/-/./g'
}

build() {
  cd "${srcdir}/${pkgname}"
  $(PYTHON) sys/meson.py --prefix="/usr" --shared
}

package() {
  cd "${srcdir}/${pkgname}"
  DESTDIR="${pkgdir}" ninja -C build install
  ln -s "radare2" "${pkgdir}/usr/bin/r2"
}

